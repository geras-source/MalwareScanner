using System;

namespace MalwareScanner.Report
{
    /// <summary>
    /// 
    /// </summary>
    public class ReportModel
    {
        /// <summary>
        /// Общее количество обработанных данных
        /// </summary>
        public int ProcessedFiles { get; set; }
        /// <summary>
        /// Количество файлов с расширением js
        /// </summary>
        public int JsDetecting { get; set; }
        /// <summary>
        /// Количество файлов хранящие строку rm -rf %userprofile%\Documents
        /// </summary>
        public int RmDetecting { get; set; }
        /// <summary>
        /// Количество файлов хранящие строку Rundll32 sus.dll SusEntry
        /// </summary>
        public int Rundll32Detecting { get; set; }
        /// <summary>
        /// Количество файлов, которые не получилось прочитать
        /// </summary>
        public int Errors { get; set; }
        /// <summary>
        /// Время выполнения программы
        /// </summary>
        public TimeSpan ExectionTime { get; set; }
        /// <summary>
        /// Переопределенный метод служащий для упрощения получения отчета по заготовленному шаблону
        /// </summary>
        /// <returns>Возвращает строку с данными по шаблону</returns>
        public override string ToString()
        {
            return "====== Scan result ======\n" +
                   $"Processed files: {ProcessedFiles}\n" +
                   $"JS detects: {JsDetecting}\n" +
                   $"rm -rf detects: {RmDetecting}\n" +
                   $"Rundll32 detects: {Rundll32Detecting}\n" +
                   $"Errors: {Errors}\n" +
                   $"Exection time: {ExectionTime:hh\\:mm\\:ss\\:fff}\n" +
                   $"=========================";
        }
    }
}